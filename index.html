<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Minesweeper</title>

    <link rel="stylesheet" href="stylesheets/main.css">
    <meta name="viewport" content="width=device-width, initial-scale=1">
  </head>
  <body>
    <header>
      <div class="description">Use left click to open and long or right click to flag mine</div>
      <a href="https://github.com/EvgenyZhlobo/minesweeper" class="forkme">Fork me on GitHub</a>
    </header>
    <section>
      <div id="workplace"></div>
      <div id="message" style="display: none;">You are win!</div>
    </section>
    <footer>
      <div class="description">Use hash to change size (ex. <a href="#7-7">#7-7</a>)</div>
    </footer>

    <script src="https://raw.github.com/EvgenyZhlobo/minesweeper/master/main.js"></script>
    <script>
var
  loc = window.location,
  width = 5,
  height = 5,
  boxSizePx = 30,
  minesweeper = new Minesweeper([width, height], boxSizePx);

var refreshMinesweeper = function( string ) {
  minesweeper.refresh(string.substr(1).split("-"), boxSizePx);
};

if ( loc.hash ) {
  refreshMinesweeper(loc.hash);
}

var hashChanged = function() {
  refreshMinesweeper(loc.hash);
};

window.addEventListener("hashchange", hashChanged, false);

var messageBlock = document.getElementById("message");
messageBlock.style.display = "none";

var message = function( text ) {
  messageBlock.innerHTML = text;
  messageBlock.style.display = "block";
  minesweeper.fn.cleanWorkplaceNode();
};

var hideMessage = function() {
  messageBlock.style.display = "none";
  if ( loc.hash ) {
    refreshMinesweeper(loc.hash);
  } else {
    minesweeper.refresh([width, height], boxSizePx);
  }
};

messageBlock.addEventListener("click", hideMessage, false);

minesweeper.action.lost = function() {
  message("Game over!")
};

minesweeper.action.won = function() {
  message("You are win!")
};
    </script>
  </body>
</html>
